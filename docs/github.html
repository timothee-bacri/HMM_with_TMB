<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 9 GitHub | A gentle tutorial of accelerated parameter and confidence interval estimation for Hidden Markov Models using Template Model Builder</title>
  <meta name="description" content="This accompanies the article published at [GITHUB LINK]." />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content=" 9 GitHub | A gentle tutorial of accelerated parameter and confidence interval estimation for Hidden Markov Models using Template Model Builder" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This accompanies the article published at [GITHUB LINK]." />
  <meta name="github-repo" content="timothee-bacri/HMM_with_TMB" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 9 GitHub | A gentle tutorial of accelerated parameter and confidence interval estimation for Hidden Markov Models using Template Model Builder" />
  
  <meta name="twitter:description" content="This accompanies the article published at [GITHUB LINK]." />
  

<meta name="author" content="Timothée Bacri timothee.bacri@uib.no" />
<meta name="author" content="Jan Bulla jan.bulla@uib.no" />
<meta name="author" content="Geir Berentsen geir.berentsen@nhh.no" />
<meta name="author" content="Sondre Hølleland sondre.hoelleland@hi.no" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate-gaussian-hmm.html"/>
<link rel="next" href="local-decoding-confidence-intervals.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    // close the dropdown menu when an option is clicked
    $("#allCodeButton").dropdown("toggle");
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // if code block has been labeled with class `fold-show`, show the code on init!
    var classList = $(this).attr('class').split(/\s+/);
    for (var i = 0; i < classList.length; i++) {
    if (classList[i] === 'fold-show') {
        show = true;
      }
    }

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // hack: return show to false, otherwise all next codeBlocks will be shown!
    show = false;

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn {
  margin-bottom: 4px;
}

.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}

.open > .dropdown-menu {
    display: block;
    color: #ffffff;
    background-color: #ffffff;
    background-image: none;
    border-color: #92897e;
}

.dropdown-menu > li > a {
  display: block;
  padding: 3px 20px;
  clear: both;
  font-weight: 400;
  line-height: 1.42857143;
  color: #000000;
  white-space: nowrap;
}

.dropdown-menu > li > a:hover,
.dropdown-menu > li > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
}

.dropdown-menu > .active > a,
.dropdown-menu > .active > a:hover,
.dropdown-menu > .active > a:focus {
  color: #ffffff;
  text-decoration: none;
  background-color: #e95420;
  outline: 0;
}
.dropdown-menu > .disabled > a,
.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  color: #aea79f;
}

.dropdown-menu > .disabled > a:hover,
.dropdown-menu > .disabled > a:focus {
  text-decoration: none;
  cursor: not-allowed;
  background-color: transparent;
  background-image: none;
  filter: progid:DXImageTransform.Microsoft.gradient(enabled = false);
}

.btn {
  display: inline-block;
  margin-bottom: 1;
  font-weight: normal;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  -ms-touch-action: manipulation;
      touch-action: manipulation;
  cursor: pointer;
  background-image: none;
  border: 1px solid transparent;
  padding: 4px 8px;
  font-size: 14px;
  line-height: 1.42857143;
  border-radius: 4px;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.btn:focus,
.btn:active:focus,
.btn.active:focus,
.btn.focus,
.btn:active.focus,
.btn.active.focus {
  outline: 5px auto -webkit-focus-ring-color;
  outline-offset: -2px;
}
.btn:hover,
.btn:focus,
.btn.focus {
  color: #ffffff;
  text-decoration: none;
}
.btn:active,
.btn.active {
  background-image: none;
  outline: 0;
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn.disabled,
.btn[disabled],
fieldset[disabled] .btn {
  cursor: not-allowed;
  filter: alpha(opacity=65);
  opacity: 0.65;
  box-shadow: none;
}
a.btn.disabled,
fieldset[disabled] a.btn {
  pointer-events: none;
}
.btn-default {
  color: #ffffff;
  background-color: #aea79f; #important
  border-color: #aea79f;
}

.btn-default:focus,
.btn-default.focus {
  color: #ffffff;
  background-color: #978e83;
  border-color: #6f675e;
}

.btn-default:hover {
  color: #ffffff;
  background-color: #978e83;
  border-color: #92897e;
}
.btn-default:active,
.btn-default.active,
.btn-group > .btn:not(:first-child):not(:last-child):not(.dropdown-toggle) {
  border-radius: 0;
}
.btn-group > .btn:first-child {
  margin-left: 0;
}
.btn-group > .btn:first-child:not(:last-child):not(.dropdown-toggle) {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn:last-child:not(:first-child),
.btn-group > .dropdown-toggle:not(:first-child) {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group > .btn-group {
  float: left;
}
.btn-group > .btn-group:not(:first-child):not(:last-child) > .btn {
  border-radius: 0;
}
.btn-group > .btn-group:first-child:not(:last-child) > .btn:last-child,
.btn-group > .btn-group:first-child:not(:last-child) > .dropdown-toggle {
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;
}
.btn-group > .btn-group:last-child:not(:first-child) > .btn:first-child {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.btn-group .dropdown-toggle:active,
.btn-group.open .dropdown-toggle {
  outline: 0;
}
.btn-group > .btn + .dropdown-toggle {
  padding-right: 8px;
  padding-left: 8px;
}
.btn-group > .btn-lg + .dropdown-toggle {
  padding-right: 12px;
  padding-left: 12px;
}
.btn-group.open .dropdown-toggle {
  box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.125);
}
.btn-group.open .dropdown-toggle.btn-link {
  box-shadow: none;
}

</style>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="width.css" type="text/css" />
<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A gentle tutorial of accelerated<br>parameter and confidence interval<br>estimation for Hidden Markov Models<BR>using Template Model Builder</a></li>
<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="principles-of-using-tmb-for-mle.html"><a href="principles-of-using-tmb-for-mle.html"><i class="fa fa-check"></i><b>2</b> Principles of using <code>TMB</code> for MLE</a>
<ul>
<li class="chapter" data-level="2.1" data-path="principles-of-using-tmb-for-mle.html"><a href="principles-of-using-tmb-for-mle.html#setup"><i class="fa fa-check"></i><b>2.1</b> Setup</a></li>
<li class="chapter" data-level="2.2" data-path="principles-of-using-tmb-for-mle.html"><a href="principles-of-using-tmb-for-mle.html#linear-regression-example"><i class="fa fa-check"></i><b>2.2</b> Linear regression example</a></li>
<li class="chapter" data-level="2.3" data-path="principles-of-using-tmb-for-mle.html"><a href="principles-of-using-tmb-for-mle.html#extending-the-c-nll"><i class="fa fa-check"></i><b>2.3</b> Extending the <code>C++</code> nll</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html"><i class="fa fa-check"></i><b>3</b> Parameter estimation techniques<br>for HMMs</a>
<ul>
<li class="chapter" data-level="3.1" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#basic-notation-and-model-setup"><i class="fa fa-check"></i><b>3.1</b> Basic notation and model setup</a></li>
<li class="chapter" data-level="3.2" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#the-likelihood-function-of-an-hmm"><i class="fa fa-check"></i><b>3.2</b> The likelihood function of an HMM</a></li>
<li class="chapter" data-level="3.3" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#forward-backward"><i class="fa fa-check"></i><b>3.3</b> Forward algorithm and<br>backward algorithm</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#setup-1"><i class="fa fa-check"></i><b>3.3.1</b> Setup</a>
<ul>
<li class="chapter" data-level="3.3.1.1" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#prepare-the-model"><i class="fa fa-check"></i><b>3.3.1.1</b> Prepare the model</a></li>
<li class="chapter" data-level="3.3.1.2" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#define-variables"><i class="fa fa-check"></i><b>3.3.1.2</b> Define variables</a></li>
<li class="chapter" data-level="3.3.1.3" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#emissionoutput-probabilities"><i class="fa fa-check"></i><b>3.3.1.3</b> Emission/output probabilities</a></li>
</ul></li>
<li class="chapter" data-level="3.3.2" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#log-forward"><i class="fa fa-check"></i><b>3.3.2</b> Log-forward probabilities</a></li>
<li class="chapter" data-level="3.3.3" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#log-backward"><i class="fa fa-check"></i><b>3.3.3</b> Log-backward probabilities</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#reparameterization-of-the-likelihood-function"><i class="fa fa-check"></i><b>3.4</b> Reparameterization of the<br>likelihood function</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#utility-functions-in-tmb"><i class="fa fa-check"></i><b>3.4.1</b> Utility functions in <code>TMB</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#utility-functions-in-r"><i class="fa fa-check"></i><b>3.4.2</b> Utility functions in <code>R</code></a>
<ul>
<li class="chapter" data-level="3.4.2.1" data-path="parameter-estimation-techniques-for-hmms.html"><a href="parameter-estimation-techniques-for-hmms.html#label-switching"><i class="fa fa-check"></i><b>3.4.2.1</b> Label switching</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using-tmb.html"><a href="using-tmb.html"><i class="fa fa-check"></i><b>4</b> Using <code>TMB</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="using-tmb.html"><a href="using-tmb.html#likelihood-function"><i class="fa fa-check"></i><b>4.1</b> Likelihood function</a></li>
<li class="chapter" data-level="4.2" data-path="using-tmb.html"><a href="using-tmb.html#optimization"><i class="fa fa-check"></i><b>4.2</b> Optimization</a></li>
<li class="chapter" data-level="4.3" data-path="using-tmb.html"><a href="using-tmb.html#basic-nested-model-specification"><i class="fa fa-check"></i><b>4.3</b> Basic nested model<br>specification</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="using-tmb.html"><a href="using-tmb.html#principle"><i class="fa fa-check"></i><b>4.3.1</b> Principle</a></li>
<li class="chapter" data-level="4.3.2" data-path="using-tmb.html"><a href="using-tmb.html#limits"><i class="fa fa-check"></i><b>4.3.2</b> Limits</a></li>
<li class="chapter" data-level="4.3.3" data-path="using-tmb.html"><a href="using-tmb.html#param-eq-constraints"><i class="fa fa-check"></i><b>4.3.3</b> Parameter equality<br>constraints</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="using-tmb.html"><a href="using-tmb.html#state-inference"><i class="fa fa-check"></i><b>4.4</b> State inference and forecasting</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="using-tmb.html"><a href="using-tmb.html#local-decoding"><i class="fa fa-check"></i><b>4.4.1</b> Local decoding</a></li>
<li class="chapter" data-level="4.4.2" data-path="using-tmb.html"><a href="using-tmb.html#forecast"><i class="fa fa-check"></i><b>4.4.2</b> Forecast</a></li>
<li class="chapter" data-level="4.4.3" data-path="using-tmb.html"><a href="using-tmb.html#global-decoding"><i class="fa fa-check"></i><b>4.4.3</b> Global decoding</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="using-tmb.html"><a href="using-tmb.html#appendix"><i class="fa fa-check"></i><b>4.5</b> Appendix</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="confidence-intervals.html"><a href="confidence-intervals.html"><i class="fa fa-check"></i><b>5</b> Confidence intervals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#Wald-type"><i class="fa fa-check"></i><b>5.1</b> Wald-type confidence<br>intervals based on the Hessian</a></li>
<li class="chapter" data-level="5.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#likelihood-profile-based-confidence-intervals"><i class="fa fa-check"></i><b>5.2</b> Likelihood profile based<br>confidence intervals</a></li>
<li class="chapter" data-level="5.3" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap-based-confidence-intervals"><i class="fa fa-check"></i><b>5.3</b> Bootstrap-based<br>confidence intervals</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="confidence-intervals.html"><a href="confidence-intervals.html#generating-data"><i class="fa fa-check"></i><b>5.3.1</b> Generating data</a></li>
<li class="chapter" data-level="5.3.2" data-path="confidence-intervals.html"><a href="confidence-intervals.html#bootstrap"><i class="fa fa-check"></i><b>5.3.2</b> Bootstrap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="application-to-different-data-sets.html"><a href="application-to-different-data-sets.html"><i class="fa fa-check"></i><b>6</b> Application to different data sets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="application-to-different-data-sets.html"><a href="application-to-different-data-sets.html#tyt-data"><i class="fa fa-check"></i><b>6.1</b> TYT data</a></li>
<li class="chapter" data-level="6.2" data-path="application-to-different-data-sets.html"><a href="application-to-different-data-sets.html#lamb-data"><i class="fa fa-check"></i><b>6.2</b> Lamb data</a></li>
<li class="chapter" data-level="6.3" data-path="application-to-different-data-sets.html"><a href="application-to-different-data-sets.html#simulated-data"><i class="fa fa-check"></i><b>6.3</b> Simulated data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gaussian-hmm.html"><a href="gaussian-hmm.html"><i class="fa fa-check"></i><b>7</b> Gaussian HMM</a>
<ul>
<li class="chapter" data-level="7.1" data-path="gaussian-hmm.html"><a href="gaussian-hmm.html#dataset"><i class="fa fa-check"></i><b>7.1</b> Dataset</a></li>
<li class="chapter" data-level="7.2" data-path="gaussian-hmm.html"><a href="gaussian-hmm.html#likelihood-function-1"><i class="fa fa-check"></i><b>7.2</b> Likelihood function</a></li>
<li class="chapter" data-level="7.3" data-path="gaussian-hmm.html"><a href="gaussian-hmm.html#estimation"><i class="fa fa-check"></i><b>7.3</b> Estimation</a></li>
<li class="chapter" data-level="7.4" data-path="gaussian-hmm.html"><a href="gaussian-hmm.html#results"><i class="fa fa-check"></i><b>7.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multivariate-gaussian-hmm.html"><a href="multivariate-gaussian-hmm.html"><i class="fa fa-check"></i><b>8</b> Multivariate Gaussian HMM</a>
<ul>
<li class="chapter" data-level="8.1" data-path="multivariate-gaussian-hmm.html"><a href="multivariate-gaussian-hmm.html#dataset-parameters"><i class="fa fa-check"></i><b>8.1</b> Dataset &amp; Parameters</a></li>
<li class="chapter" data-level="8.2" data-path="multivariate-gaussian-hmm.html"><a href="multivariate-gaussian-hmm.html#likelihood-function-2"><i class="fa fa-check"></i><b>8.2</b> Likelihood function</a></li>
<li class="chapter" data-level="8.3" data-path="multivariate-gaussian-hmm.html"><a href="multivariate-gaussian-hmm.html#estimation-1"><i class="fa fa-check"></i><b>8.3</b> Estimation</a></li>
<li class="chapter" data-level="8.4" data-path="multivariate-gaussian-hmm.html"><a href="multivariate-gaussian-hmm.html#results-1"><i class="fa fa-check"></i><b>8.4</b> Results</a></li>
<li class="chapter" data-level="8.5" data-path="multivariate-gaussian-hmm.html"><a href="multivariate-gaussian-hmm.html#bias"><i class="fa fa-check"></i><b>8.5</b> Bias</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>9</b> GitHub</a>
<ul>
<li class="chapter" data-level="9.1" data-path="github.html"><a href="github.html#directory-structure"><i class="fa fa-check"></i><b>9.1</b> Directory structure</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="github.html"><a href="github.html#code"><i class="fa fa-check"></i><b>9.1.1</b> code/</a></li>
<li class="chapter" data-level="9.1.2" data-path="github.html"><a href="github.html#linreg.cpp"><i class="fa fa-check"></i><b>9.1.2</b> code/linreg.cpp</a></li>
<li class="chapter" data-level="9.1.3" data-path="github.html"><a href="github.html#linreg_extended.cpp"><i class="fa fa-check"></i><b>9.1.3</b> code/linreg_extended.cpp</a></li>
<li class="chapter" data-level="9.1.4" data-path="github.html"><a href="github.html#main.R"><i class="fa fa-check"></i><b>9.1.4</b> code/main.R</a></li>
<li class="chapter" data-level="9.1.5" data-path="github.html"><a href="github.html#mvnorm_hmm.cpp"><i class="fa fa-check"></i><b>9.1.5</b> code/mvnorm_hmm.cpp</a></li>
<li class="chapter" data-level="9.1.6" data-path="github.html"><a href="github.html#norm_hmm.cpp"><i class="fa fa-check"></i><b>9.1.6</b> code/norm_hmm.cpp</a></li>
<li class="chapter" data-level="9.1.7" data-path="github.html"><a href="github.html#codepackages.r"><i class="fa fa-check"></i><b>9.1.7</b> code/packages.R</a></li>
<li class="chapter" data-level="9.1.8" data-path="github.html"><a href="github.html#poi_hmm.cpp"><i class="fa fa-check"></i><b>9.1.8</b> code/poi_hmm.cpp</a></li>
<li class="chapter" data-level="9.1.9" data-path="github.html"><a href="github.html#poi_hmm_smoothing.cpp"><i class="fa fa-check"></i><b>9.1.9</b> code/poi_hmm_smoothing.cpp</a></li>
<li class="chapter" data-level="9.1.10" data-path="github.html"><a href="github.html#poi_hmm_smoothing_truncated.cpp"><i class="fa fa-check"></i><b>9.1.10</b> code/poi_hmm_smoothing_truncated.cpp</a></li>
<li class="chapter" data-level="9.1.11" data-path="github.html"><a href="github.html#poi_hmm_lamb.R"><i class="fa fa-check"></i><b>9.1.11</b> code/poi_hmm_lamb.R</a></li>
<li class="chapter" data-level="9.1.12" data-path="github.html"><a href="github.html#poi_hmm_simu1.R"><i class="fa fa-check"></i><b>9.1.12</b> code/poi_hmm_simu1.R</a></li>
<li class="chapter" data-level="9.1.13" data-path="github.html"><a href="github.html#poi_hmm_simu2.R"><i class="fa fa-check"></i><b>9.1.13</b> code/poi_hmm_simu2.R</a></li>
<li class="chapter" data-level="9.1.14" data-path="github.html"><a href="github.html#poi_hmm_simu3.R"><i class="fa fa-check"></i><b>9.1.14</b> code/poi_hmm_simu3.R</a></li>
<li class="chapter" data-level="9.1.15" data-path="github.html"><a href="github.html#poi_hmm_simu4.R"><i class="fa fa-check"></i><b>9.1.15</b> code/poi_hmm_simu4.R</a></li>
<li class="chapter" data-level="9.1.16" data-path="github.html"><a href="github.html#poi_hmm_tinn.R"><i class="fa fa-check"></i><b>9.1.16</b> code/poi_hmm_tinn.R</a></li>
<li class="chapter" data-level="9.1.17" data-path="github.html"><a href="github.html#setup_parameters.R"><i class="fa fa-check"></i><b>9.1.17</b> code/setup_parameters.R</a></li>
<li class="chapter" data-level="9.1.18" data-path="github.html"><a href="github.html#data"><i class="fa fa-check"></i><b>9.1.18</b> data/</a></li>
<li class="chapter" data-level="9.1.19" data-path="github.html"><a href="github.html#fetal-lamb.RData"><i class="fa fa-check"></i><b>9.1.19</b> data/fetal-lamb.RData</a></li>
<li class="chapter" data-level="9.1.20" data-path="github.html"><a href="github.html#dataresults_lamb.rdata"><i class="fa fa-check"></i><b>9.1.20</b> data/results_lamb.RData</a></li>
<li class="chapter" data-level="9.1.21" data-path="github.html"><a href="github.html#dataresults_simu1.rdata"><i class="fa fa-check"></i><b>9.1.21</b> data/results_simu1.RData</a></li>
<li class="chapter" data-level="9.1.22" data-path="github.html"><a href="github.html#dataresults_simu2.rdata"><i class="fa fa-check"></i><b>9.1.22</b> data/results_simu2.RData</a></li>
<li class="chapter" data-level="9.1.23" data-path="github.html"><a href="github.html#dataresults_simu3.rdata"><i class="fa fa-check"></i><b>9.1.23</b> data/results_simu3.RData</a></li>
<li class="chapter" data-level="9.1.24" data-path="github.html"><a href="github.html#dataresults_simu4.rdata"><i class="fa fa-check"></i><b>9.1.24</b> data/results_simu4.RData</a></li>
<li class="chapter" data-level="9.1.25" data-path="github.html"><a href="github.html#dataresults_tinn.rdata"><i class="fa fa-check"></i><b>9.1.25</b> data/results_tinn.RData</a></li>
<li class="chapter" data-level="9.1.26" data-path="github.html"><a href="github.html#tinnitus.RData"><i class="fa fa-check"></i><b>9.1.26</b> data/tinnitus.RData</a></li>
<li class="chapter" data-level="9.1.27" data-path="github.html"><a href="github.html#functions"><i class="fa fa-check"></i><b>9.1.27</b> functions/</a></li>
<li class="chapter" data-level="9.1.28" data-path="github.html"><a href="github.html#mvnorm_utils.cpp"><i class="fa fa-check"></i><b>9.1.28</b> functions/mvnorm_utils.cpp</a></li>
<li class="chapter" data-level="9.1.29" data-path="github.html"><a href="github.html#mvnorm_utils.R"><i class="fa fa-check"></i><b>9.1.29</b> functions/mvnorm_utils.R</a></li>
<li class="chapter" data-level="9.1.30" data-path="github.html"><a href="github.html#norm_utils.cpp"><i class="fa fa-check"></i><b>9.1.30</b> functions/norm_utils.cpp</a></li>
<li class="chapter" data-level="9.1.31" data-path="github.html"><a href="github.html#norm_utils.R"><i class="fa fa-check"></i><b>9.1.31</b> functions/norm_utils.R</a></li>
<li class="chapter" data-level="9.1.32" data-path="github.html"><a href="github.html#utils.cpp"><i class="fa fa-check"></i><b>9.1.32</b> functions/utils.cpp</a></li>
<li class="chapter" data-level="9.1.33" data-path="github.html"><a href="github.html#utils.R"><i class="fa fa-check"></i><b>9.1.33</b> functions/utils.R</a></li>
<li class="chapter" data-level="9.1.34" data-path="github.html"><a href="github.html#utils.R-explanation.R"><i class="fa fa-check"></i><b>9.1.34</b> functions/utils.R-explanation.R</a></li>
<li class="chapter" data-level="9.1.35" data-path="github.html"><a href="github.html#utils_linreg_extended.cpp"><i class="fa fa-check"></i><b>9.1.35</b> functions/utils_linreg_extended.cpp</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="local-decoding-confidence-intervals.html"><a href="local-decoding-confidence-intervals.html"><i class="fa fa-check"></i><b>10</b> Local decoding confidence intervals</a>
<ul>
<li class="chapter" data-level="10.1" data-path="local-decoding-confidence-intervals.html"><a href="local-decoding-confidence-intervals.html#likelihood-function-poisson-hmm"><i class="fa fa-check"></i><b>10.1</b> Likelihood function (Poisson HMM)</a></li>
<li class="chapter" data-level="10.2" data-path="local-decoding-confidence-intervals.html"><a href="local-decoding-confidence-intervals.html#estimation-2"><i class="fa fa-check"></i><b>10.2</b> Estimation</a></li>
<li class="chapter" data-level="10.3" data-path="local-decoding-confidence-intervals.html"><a href="local-decoding-confidence-intervals.html#results-2"><i class="fa fa-check"></i><b>10.3</b> Results</a></li>
<li class="chapter" data-level="10.4" data-path="local-decoding-confidence-intervals.html"><a href="local-decoding-confidence-intervals.html#limitation"><i class="fa fa-check"></i><b>10.4</b> Limitation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A gentle tutorial of accelerated parameter and confidence interval estimation for Hidden Markov Models using Template Model Builder</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="github" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number"> 9</span> GitHub<a href="github.html#github" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For reading more easily, we recommend opening the file <em>Data supplements.Rproj</em> with R-Studio, which lets the user have the correct working path set up automatically.
Other files can be opened directly by double-clicking on them, or via the <code>Files</code> tab in R-Studio.<br />
Most of the code can be folded/collapsed into sections easily by clicking in the menu <code>Edit</code>-&gt;<code>Collapse All Output</code>.<br />
Unfolding can be done by clicking on the arrows to the left of the folded sections, or in the menu <code>Edit</code>-&gt;<code>Expand All Output</code>.</p>
<div id="directory-structure" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Directory structure<a href="github.html#directory-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For readability, folders are displayed with a dash at the end.
The folder code will be at the section <em><a href="github.html#code">code/</a></em>.</p>
<div id="code" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> code/<a href="github.html#code" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Files required to compute the main results of the article: acceleration factors and coverage probabilities.</p>
<p>Folder on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code</a></p>
</div>
<div id="linreg.cpp" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> code/linreg.cpp<a href="github.html#linreg.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifies the function computing the negative log-likelihood of a linear regression in <code>C++</code>.
Heavily inspired by <a href="https://github.com/kaskr/adcomp/blob/master/tmb_examples/linreg.cpp" class="uri">https://github.com/kaskr/adcomp/blob/master/tmb_examples/linreg.cpp</a>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg.cpp</a></p>
<!-- ### code/linreg.dll -->
<!-- Generated automatically by compiling *[code/linreg.cpp](#linreg.cpp)*. -->
<!-- Library that contains code and data that can be used by more than one program at the same time. -->
<!-- Used to compute negative log-likelihoods in `R` with `TMB`. -->
<!-- File on GitHub: https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg.dll \ -->
<!-- File: https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg.dll -->
<!-- ### code/linreg.o {#linreg.o} -->
<!-- Generated by compiling *[code/linreg.cpp](#linreg.cpp)*. -->
<!-- Used to compute negative log-likelihoods in `R` with `TMB`. -->
<!-- File on GitHub: https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg.o \ -->
<!-- File: https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg.o -->
</div>
<div id="linreg_extended.cpp" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> code/linreg_extended.cpp<a href="github.html#linreg_extended.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar to <em><a href="github.html#linreg.cpp">code/linreg.cpp</a></em>, with some more complex code added to serve as an example.
Used to compute negative log-likelihoods in <code>R</code> with <code>TMB</code>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg_extended.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg_extended.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg_extended.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg_extended.cpp</a></p>
<!-- ### code/linreg_extended.dll -->
<!-- Generated automatically by compiling *[code/linreg_extended.cpp](#linreg_extended.cpp)*. -->
<!-- Similar to *[code/linreg.cpp](#linreg.cpp)*. -->
<!-- Used to compute negative log-likelihoods in `R` with `TMB`. -->
<!-- File on GitHub: https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg_extended.dll \ -->
<!-- File: https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg_extended.dll -->
<!-- ### code/linreg_extended.o -->
<!-- Generated by compiling *[code/linreg.cpp](#linreg.cpp)*. -->
<!-- Similar to *[code/linreg.o](#linreg.o)*. -->
<!-- Used to compute negative log-likelihoods in `R` with `TMB`. -->
<!-- File on GitHub: https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/linreg_extended.o \ -->
<!-- File: https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/linreg_extended.o -->
</div>
<div id="main.R" class="section level3 hasAnchor" number="9.1.4">
<h3><span class="header-section-number">9.1.4</span> code/main.R<a href="github.html#main.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Used to run procedures related to timing and comparisons presented in the article.
By default, it will load results instead.</p>
<p>The first chunk of code it runs can be found in the file <em><a href="github.html#setup_parameters.R">code/setup_parameters.R</a></em>.<br />
Afterwards, either computations are run and their results are stored in data/, or results are loaded to the current environment.
The computations are written in <em><a href="github.html#poi_hmm_tinn.R">code/poi_hmm_tinn.R</a></em>, <em><a href="github.html#poi_hmm_lamb.R">code/poi_hmm_lamb.R</a></em>, <em><a href="github.html#poi_hmm_simu1.R">code/poi_hmm_simu1.R</a></em>, <em><a href="github.html#poi_hmm_simu2.R">code/poi_hmm_simu2.R</a></em>, <em><a href="github.html#poi_hmm_simu3.R">code/poi_hmm_simu3.R</a></em>, and <em><a href="github.html#poi_hmm_simu4.R">code/poi_hmm_simu4.R</a></em>.</p>
<p><strong>NOTE</strong>: Our scripts were tested on a workstation with 4 Intel(R) Xeon(R) Gold 6134 processors (3.7 GHz) running under the Linux distribution Ubuntu 18.04.6 LTS (Bionic Beaver) with 384 GB, and took about a week of computing time.
More details are available at individual files.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/main.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/main.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/main.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/main.R</a></p>
</div>
<div id="mvnorm_hmm.cpp" class="section level3 hasAnchor" number="9.1.5">
<h3><span class="header-section-number">9.1.5</span> code/mvnorm_hmm.cpp<a href="github.html#mvnorm_hmm.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifies the function computing the negative log-likelihood of a m-state multivariate Gaussian Hidden Markov Model in <code>C++</code>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/mvnorm_hmm.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/mvnorm_hmm.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/mvnorm_hmm.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/mvnorm_hmm.cpp</a></p>
</div>
<div id="norm_hmm.cpp" class="section level3 hasAnchor" number="9.1.6">
<h3><span class="header-section-number">9.1.6</span> code/norm_hmm.cpp<a href="github.html#norm_hmm.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifies the function computing the negative log-likelihood of a m-state univariate Gaussian Hidden Markov Model in <code>C++</code>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/norm_hmm.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/norm_hmm.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/norm_hmm.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/norm_hmm.cpp</a></p>
</div>
<div id="codepackages.r" class="section level3 hasAnchor" number="9.1.7">
<h3><span class="header-section-number">9.1.7</span> code/packages.R<a href="github.html#codepackages.r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Automatically install/load necessary packages for running <em><a href="github.html#main.R">code/main.R</a></em> with all simulations.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/packages.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/packages.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/packages.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/packages.R</a></p>
</div>
<div id="poi_hmm.cpp" class="section level3 hasAnchor" number="9.1.8">
<h3><span class="header-section-number">9.1.8</span> code/poi_hmm.cpp<a href="github.html#poi_hmm.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifies the function computing the negative log-likelihood of a m-state Poisson Hidden Markov Model in <code>C++</code>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm.cpp</a></p>
</div>
<div id="poi_hmm_smoothing.cpp" class="section level3 hasAnchor" number="9.1.9">
<h3><span class="header-section-number">9.1.9</span> code/poi_hmm_smoothing.cpp<a href="github.html#poi_hmm_smoothing.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifies the function computing the negative log-likelihood of a m-state Poisson Hidden Markov Model in <code>C++</code>.
Additionally, returns smoothing probabilities.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_smoothing.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_smoothing.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_smoothing.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_smoothing.cpp</a></p>
</div>
<div id="poi_hmm_smoothing_truncated.cpp" class="section level3 hasAnchor" number="9.1.10">
<h3><span class="header-section-number">9.1.10</span> code/poi_hmm_smoothing_truncated.cpp<a href="github.html#poi_hmm_smoothing_truncated.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Specifies the function computing the negative log-likelihood of a m-state Poisson Hidden Markov Model in <code>C++</code>.
Additionally, returns (optionally truncated) smoothing probabilities.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_smoothing_truncated.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_smoothing_truncated.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_smoothing_truncated.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_smoothing_truncated.cpp</a></p>
</div>
<div id="poi_hmm_lamb.R" class="section level3 hasAnchor" number="9.1.11">
<h3><span class="header-section-number">9.1.11</span> code/poi_hmm_lamb.R<a href="github.html#poi_hmm_lamb.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_lamb.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_lamb.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_lamb.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_lamb.R</a></p>
<p>On our machine, this file took approximately 2h to compute.</p>
</div>
<div id="poi_hmm_simu1.R" class="section level3 hasAnchor" number="9.1.12">
<h3><span class="header-section-number">9.1.12</span> code/poi_hmm_simu1.R<a href="github.html#poi_hmm_simu1.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu1.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu1.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu1.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu1.R</a></p>
<p>On our machine, this file took approximately 3h30 to compute.</p>
</div>
<div id="poi_hmm_simu2.R" class="section level3 hasAnchor" number="9.1.13">
<h3><span class="header-section-number">9.1.13</span> code/poi_hmm_simu2.R<a href="github.html#poi_hmm_simu2.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu2.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu2.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu2.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu2.R</a></p>
<p>On our machine, this file took approximately 23h to compute.</p>
</div>
<div id="poi_hmm_simu3.R" class="section level3 hasAnchor" number="9.1.14">
<h3><span class="header-section-number">9.1.14</span> code/poi_hmm_simu3.R<a href="github.html#poi_hmm_simu3.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unlike in the other simulations, the coverage probabilities computation code does not ensure that profile CIs converge.
This is solved in the fourth simulation with a larger dataset size, and shows that care must be taken when dealing with profile CIs because they can fail to produce results.<br />
File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu3.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu3.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu3.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu3.R</a></p>
<p>On our machine, this file took approximately 26h30 to compute.</p>
</div>
<div id="poi_hmm_simu4.R" class="section level3 hasAnchor" number="9.1.15">
<h3><span class="header-section-number">9.1.15</span> code/poi_hmm_simu4.R<a href="github.html#poi_hmm_simu4.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu3.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_simu3.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu3.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_simu3.R</a></p>
<p>On our machine, this file took approximately 63h to compute.</p>
</div>
<div id="poi_hmm_tinn.R" class="section level3 hasAnchor" number="9.1.16">
<h3><span class="header-section-number">9.1.16</span> code/poi_hmm_tinn.R<a href="github.html#poi_hmm_tinn.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Most of their code is common:</p>
<ul>
<li><p><code>Parameters and covariates</code> defines parameters and covariates in natural form. The simulation files generate data there.</p></li>
<li><p><code>Parameters &amp; covariates for TMB</code> transforms parameters and covariates to their working form.</p></li>
<li><p><code>Estimation</code> computes estimates with and without TMB for further comparison. The estimates are stored in the data-frames <code>conf_int_*</code>.</p></li>
<li><p><code>Creating variables for the CIs</code> creates necessary variables for to compute confidence intervals (CIs).</p></li>
<li><p><code>Benchmarks</code> uses the <code>microbenchmark</code> <span class="citation">(<a href="references.html#ref-R-microbenchmark" role="doc-biblioref">Mersmann 2021</a>)</span> package to accurately time the <span class="math inline">\(TMB_0\)</span> <span class="math inline">\(TMB_G\)</span> <span class="math inline">\(TMB_H\)</span> and <span class="math inline">\(TMB_{GH}\)</span> procedures. Their times are stored in the data-frames <code>estim_benchmarks_df_*</code></p></li>
<li><p><code>Profiling the likelihood</code> uses the <code>TMB</code> package’s <code>tmbprofile</code> function to determine a profile of the likelihood, then determines a CI based on it for the corresponding working parameter. Eventually, CIs are derived when possible for the natural parameters <span class="math inline">\(\hat{{\boldsymbol\lambda}}\)</span> and <span class="math inline">\(\hat{{\boldsymbol\Gamma}}\)</span>. The CIs are stored in the data-frames <code>conf_int_*</code>.</p></li>
<li><p><code>Bootstrap</code> derives a parametric bootstrap CI from the dataset, while checking that the generated data can be estimated without errors, after which we apply our label switching function to ensure that estimates of a parameter are only aggregated with estimates of the same parameter. The CIs are stored in the data-frames <code>conf_int_*</code>.</p></li>
<li><p><code>TMB confidence intervals</code> computes CIs based on <code>TMB</code>-derived standard errors. The CIs are stored in the data-frames <code>conf_int_*</code>.</p></li>
<li><p><code>Coverage probabilities of the 3 CI methods</code> simulates coverage samples based on true values when available or on estimates otherwise, then derives CIs using the three CI generation methods described above. The coverage probabilities are stored in the data-frames <code>conf_int_*</code>.</p></li>
<li><p><code>Fixes</code> uses the label-switching algorithm on the estimates in the <code>conf_int_*</code> variable to ensure they are correctly ordered, and then reorders <span class="math inline">\(\hat{{\boldsymbol\Gamma}}\)</span> in the <code>conf_int_*</code> variable to a row-wise order instead of the default column-wise order. In short this applies two fixes on the <code>conf_int_*</code> variable to make it easier to read.<br />
At the end, we reorder the profile likelihood based CIs in case they are not in ascending order.</p></li>
</ul>
<p>A unique randomness seed is set in each of these four files before all time-consuming tasks involving some randomness.
<em><a href="github.html#setup_parameters.R">code/setup_parameters.R</a></em> defines the random number generator’s version.</p>
<p><em><a href="github.html#poi_hmm_tinn.R">code/poi_hmm_tinn.R</a></em> contains an extra section: <code>Benchmark the same dataset many times to check the benchmark durations has low variance</code>.
As written in its title, its role is to time estimation with and without <code>TMB</code>.
However, unlike in the section <code>Benchmarks</code>, estimation is done on the same dataset everytime.
If everything goes well, the times should have a negligible variance.
This allows us to check if normal background activity on the computer (e.g. the user opening a window or moving the mouse) affects estimation time in any noticeable way.
If it affects estimation noticeably, then we would have to apply much stricter control on background processes in order to reliably compare estimation speeds with different optimizers.
Luckily, a low variance was observed, making the acceleration evidenced in this project significant.</p>
<p><strong>NOTE</strong>: to be faster, some code is parallelized:</p>
<ul>
<li>In <em><a href="github.html#poi_hmm_simu1.R">code/poi_hmm_simu1.R</a></em>, bootstrapping is parallelized both in <code>Bootstrap</code> (accelerated from 83 seconds per sample to 29 seconds) and in <code>Coverage probabilities of the 3 CI methods</code> (likelihood profiling was slower with parallelization, likely due to loading <code>TMB</code> each time and the procedure being already fairly quick: from 2.8 seconds in total without to 3.5 seconds in total with).</li>
<li>In <em><a href="github.html#poi_hmm_simu2.R">code/poi_hmm_simu2.R</a></em>, bootstrapping and likelihood profiling are both parallelized in <code>Bootstrap</code> (accelerated from 64 seconds per bootstrap sample to 21), <code>Profiling the likelihood</code>, and in <code>Coverage probabilities of the 3 CI methods</code>.</li>
<li><em><a href="github.html#poi_hmm_simu3.R">code/poi_hmm_simu3.R</a></em> and <em><a href="github.html#poi_hmm_simu4.R">code/poi_hmm_simu4.R</a></em> benefit from the same parallelization as <em><a href="github.html#poi_hmm_simu2.R">code/poi_hmm_simu2.R</a></em>.</li>
</ul>
<p>Parallelization is handled with the <code>foreach</code> <span class="citation">(<a href="references.html#ref-R-foreach" role="doc-biblioref">Revolution Analytics and Weston, n.d.</a>)</span> package and the <code>doParallel</code> <span class="citation">(<a href="references.html#ref-R-doParallel" role="doc-biblioref">Corporation and Weston 2022</a>)</span> package as a backend.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_tinn.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/poi_hmm_tinn.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_tinn.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/poi_hmm_tinn.R</a></p>
</div>
<div id="setup_parameters.R" class="section level3 hasAnchor" number="9.1.17">
<h3><span class="header-section-number">9.1.17</span> code/setup_parameters.R<a href="github.html#setup_parameters.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sets up multiple variables either to define some global constants or to store useful results for easier maintenance, and compiles <em><a href="github.html#linreg.cpp">code/linreg.cpp</a></em> and <em><a href="github.html#poi_hmm.cpp">code/poi_hmm.cpp</a></em>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/setup_parameters.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/code/setup_parameters.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/setup_parameters.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/code/setup_parameters.R</a></p>
</div>
<div id="data" class="section level3 hasAnchor" number="9.1.18">
<h3><span class="header-section-number">9.1.18</span> data/<a href="github.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Files containing both datasets and the computational results.
<em><a href="github.html#main.R">code/main.R</a></em> stores important results in this folder, and only loads them by default.</p>
<p>Speed results are available after some post-processing that we leave to the reader.</p>
<p>Folder on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data</a></p>
</div>
<div id="fetal-lamb.RData" class="section level3 hasAnchor" number="9.1.19">
<h3><span class="header-section-number">9.1.19</span> data/fetal-lamb.RData<a href="github.html#fetal-lamb.RData" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Contains <code>lamb</code>: an integer vector of with 240 data from <span class="citation">Leroux and Puterman (<a href="references.html#ref-leroux" role="doc-biblioref">1992</a>)</span>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/fetal-lamb.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/fetal-lamb.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/fetal-lamb.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/fetal-lamb.RData</a></p>
</div>
<div id="dataresults_lamb.rdata" class="section level3 hasAnchor" number="9.1.20">
<h3><span class="header-section-number">9.1.20</span> data/results_lamb.RData<a href="github.html#dataresults_lamb.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_lamb.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_lamb.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_lamb.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_lamb.RData</a></p>
</div>
<div id="dataresults_simu1.rdata" class="section level3 hasAnchor" number="9.1.21">
<h3><span class="header-section-number">9.1.21</span> data/results_simu1.RData<a href="github.html#dataresults_simu1.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu1.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu1.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu1.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu1.RData</a></p>
</div>
<div id="dataresults_simu2.rdata" class="section level3 hasAnchor" number="9.1.22">
<h3><span class="header-section-number">9.1.22</span> data/results_simu2.RData<a href="github.html#dataresults_simu2.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu2.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu2.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu2.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu2.RData</a></p>
</div>
<div id="dataresults_simu3.rdata" class="section level3 hasAnchor" number="9.1.23">
<h3><span class="header-section-number">9.1.23</span> data/results_simu3.RData<a href="github.html#dataresults_simu3.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu3.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu3.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu3.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu3.RData</a></p>
</div>
<div id="dataresults_simu4.rdata" class="section level3 hasAnchor" number="9.1.24">
<h3><span class="header-section-number">9.1.24</span> data/results_simu4.RData<a href="github.html#dataresults_simu4.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu4.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_simu4.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu4.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_simu4.RData</a></p>
</div>
<div id="dataresults_tinn.rdata" class="section level3 hasAnchor" number="9.1.25">
<h3><span class="header-section-number">9.1.25</span> data/results_tinn.RData<a href="github.html#dataresults_tinn.rdata" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Contains results from computations and timings run in <em><a href="github.html#main.R">code/main.R</a></em>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_tinn.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/results_tinn.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_tinn.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/results_tinn.RData</a></p>
</div>
<div id="tinnitus.RData" class="section level3 hasAnchor" number="9.1.26">
<h3><span class="header-section-number">9.1.26</span> data/tinnitus.RData<a href="github.html#tinnitus.RData" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tinnitus data collected with the “Track Your Tinnitus” (TYT) mobile application on 87 successive days, provided by the University of Regensburg and European School for Interdisciplinary Tinnitus Research (ESIT), of which a detailed description is presented in <span class="citation">Pryss, Reichert, Langguth, et al. (<a href="references.html#ref-pryss" role="doc-biblioref">2015</a>)</span> and <span class="citation">Pryss, Reichert, Herrmann, et al. (<a href="references.html#ref-pryssa" role="doc-biblioref">2015</a>)</span>.</p>
<p>A plot is available in Figure <a href="using-tmb.html#fig:4tinnitus-fig">4.1</a>.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/tinnitus.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/data/tinnitus.RData</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/tinnitus.RData" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/data/tinnitus.RData</a></p>
</div>
<div id="functions" class="section level3 hasAnchor" number="9.1.27">
<h3><span class="header-section-number">9.1.27</span> functions/<a href="github.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Utility functions used both in <code>C++</code> files and in <code>R</code> files.</p>
<p>Folder on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions</a></p>
</div>
<div id="mvnorm_utils.cpp" class="section level3 hasAnchor" number="9.1.28">
<h3><span class="header-section-number">9.1.28</span> functions/mvnorm_utils.cpp<a href="github.html#mvnorm_utils.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Utility functions used in <a href="multivariate-gaussian-hmm.html#multivariate-gaussian-hmm">Multivariate Gaussian HMM</a> to transform working parameters to their natural form, and to compute the hidden Markov chain’s stationary distribution when needed.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/mvnorm_utils.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/mvnorm_utils.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/mvnorm_utils.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/mvnorm_utils.cpp</a></p>
</div>
<div id="mvnorm_utils.R" class="section level3 hasAnchor" number="9.1.29">
<h3><span class="header-section-number">9.1.29</span> functions/mvnorm_utils.R<a href="github.html#mvnorm_utils.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Useful functions to estimate multivariate Gaussian HMMs with and without <code>TMB</code> and perform various pre-processing and post-processing.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/mvnorm_utils.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/mvnorm_utils.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/mvnorm_utils.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/mvnorm_utils.R</a></p>
</div>
<div id="norm_utils.cpp" class="section level3 hasAnchor" number="9.1.30">
<h3><span class="header-section-number">9.1.30</span> functions/norm_utils.cpp<a href="github.html#norm_utils.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Utility functions used in <a href="gaussian-hmm.html#gaussian-hmm">Gaussian HMM</a> to transform working parameters to their natural form, and to compute the hidden Markov chain’s stationary distribution when needed.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/norm_utils.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/norm_utils.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/norm_utils.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/norm_utils.cpp</a></p>
</div>
<div id="norm_utils.R" class="section level3 hasAnchor" number="9.1.31">
<h3><span class="header-section-number">9.1.31</span> functions/norm_utils.R<a href="github.html#norm_utils.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Useful functions to estimate Gaussian HMMs with and without <code>TMB</code> and perform various pre-processing and post-processing.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/norm_utils.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/norm_utils.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/norm_utils.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/norm_utils.R</a></p>
</div>
<div id="utils.cpp" class="section level3 hasAnchor" number="9.1.32">
<h3><span class="header-section-number">9.1.32</span> functions/utils.cpp<a href="github.html#utils.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Utility functions used in <em><a href="github.html#poi_hmm.cpp">code/poi_hmm.cpp</a></em> to transform working parameters to their natural form, and to compute the hidden Markov chain’s stationary distribution when needed.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils.cpp</a></p>
</div>
<div id="utils.R" class="section level3 hasAnchor" number="9.1.33">
<h3><span class="header-section-number">9.1.33</span> functions/utils.R<a href="github.html#utils.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Useful functions to estimate Poisson HMMs with and without <code>TMB</code> and perform various pre-processing and post-processing.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils.R</a></p>
</div>
<div id="utils.R-explanation.R" class="section level3 hasAnchor" number="9.1.34">
<h3><span class="header-section-number">9.1.34</span> functions/utils.R-explanation.R<a href="github.html#utils.R-explanation.R" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Description of the function parameters and return objects defined in <em><a href="github.html#utils.R">functions/utils.R</a></em>.<br />
The other utility files are adapted to the univariate and multivariate Gaussian setting but otherwise have identical functions.<br />
</p>
<p>Note that the article focuses on Poisson HMMs.
Hence, some utility functions in R present for the Poisson HMM are not adapted to the Gaussian HMMs.<br />
</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils.R-explanation.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils.R-explanation.R</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils.R-explanation.R" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils.R-explanation.R</a></p>
</div>
<div id="utils_linreg_extended.cpp" class="section level3 hasAnchor" number="9.1.35">
<h3><span class="header-section-number">9.1.35</span> functions/utils_linreg_extended.cpp<a href="github.html#utils_linreg_extended.cpp" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Contains the useless example function.</p>
<p>File on GitHub: <a href="https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils_linreg_extended.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/blob/main/functions/utils_linreg_extended.cpp</a><br />
File: <a href="https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils_linreg_extended.cpp" class="uri">https://github.com/timothee-bacri/HMM_with_TMB/raw/main/functions/utils_linreg_extended.cpp</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-gaussian-hmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="local-decoding-confidence-intervals.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
